<div class="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50 animate-fade-in">
  <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col border border-gray-700">
    <!-- Header -->
    <div class="flex justify-between items-center p-4 border-b border-gray-700">
      <h2 class="text-xl font-bold text-white flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-6 h-6 text-indigo-400">
            <path d="M10 2a.75.75 0 0 1 .75.75v.255a5.986 5.986 0 0 1 3.245 1.133.75.75 0 0 1-.5 1.325 4.486 4.486 0 0 0-2.745-.983V6.5a.75.75 0 0 1-1.5 0V4.48a4.486 4.486 0 0 0-2.745.983.75.75 0 1 1-.5-1.325A5.986 5.986 0 0 1 9.25 3.005V2.75A.75.75 0 0 1 10 2ZM10 8a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7ZM7.5 11.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Z" />
            <path d="M10 18.5a.75.75 0 0 1-.75-.75v-1.25a6 6 0 0 1-3.24-1.075.75.75 0 1 1 .55-1.318 4.5 4.5 0 0 0 5.38 0 .75.75 0 1 1 .55 1.318 5.999 5.999 0 0 1-3.24 1.075v1.25a.75.75 0 0 1-.75.75Z" />
        </svg>
        AI Menu Assistant
      </h2>
      <button (click)="onClose()" class="text-gray-400 hover:text-white transition">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-6 h-6">
          <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
        </svg>
      </button>
    </div>

    <!-- Content -->
    <div class="p-6 overflow-y-auto flex-grow">
      <p class="text-gray-300 mb-4">
        Tell me what you're in the mood for, and I'll suggest something from the menu!
        For example: "something spicy and vegetarian", "a light lunch", or "a comforting classic".
      </p>

      <div class="flex gap-2 mb-4">
        <input
          type="text"
          [(ngModel)]="userPreference"
          (keyup.enter)="getRecommendations()"
          placeholder="e.g., I'm looking for something healthy..."
          class="flex-grow bg-gray-700 text-white rounded-lg px-4 py-2 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          [disabled]="isLoading()"
        />
        <button
          (click)="getRecommendations()"
          [disabled]="isLoading() || !userPreference().trim()"
          class="bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed hover:bg-indigo-500"
        >
          @if (isLoading()) {
            <span>Thinking...</span>
          } @else {
            <span>Suggest</span>
          }
        </button>
      </div>

      <!-- Results -->
      <div class="mt-6">
        @if (isLoading()) {
          <div class="flex flex-col items-center justify-center p-8 text-center text-gray-400">
            <svg class="animate-spin h-8 w-8 text-indigo-400 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="font-semibold">Finding the perfect dish for you...</p>
          </div>
        }
        @if (error()) {
          <div class="bg-red-900/50 border border-red-700 text-red-300 p-4 rounded-lg">
            {{ error() }}
          </div>
        }
        @if (recommendation()) {
          <div class="bg-gray-900/50 p-4 rounded-lg border border-gray-700">
             <pre class="text-gray-300 whitespace-pre-wrap font-sans">{{ recommendation() }}</pre>
          </div>
        }
      </div>

    </div>
  </div>
</div>
